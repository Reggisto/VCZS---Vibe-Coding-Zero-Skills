<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORACLE v6.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #00ff41; font-family: monospace; padding: 10px; }
        .card { background: #111; border: 1px solid #333; padding: 10px; margin-bottom: 10px; border-radius: 4px; }
        .label { font-size: 10px; color: #888; text-transform: uppercase; }
        .val { font-size: 20px; font-weight: bold; color: #fff; }
        
        /* Terminale sempre visibile e alto */
        #log { background: #050505; border: 1px solid #00ff41; height: 150px; overflow-y: scroll; font-size: 10px; padding: 5px; margin-bottom: 10px; white-space: pre-wrap; }
        
        input[type=range] { width: 100%; height: 15px; accent-color: #00ff41; margin: 10px 0; }
        input[type=password], input[type=number] { background: #222; border: 1px solid #444; color: #00ff41; padding: 10px; width: 100%; font-size: 16px; margin-top: 5px; }
        
        .btn-big { background: #00ff41; color: #000; font-weight: 900; width: 100%; padding: 20px; font-size: 20px; border-radius: 8px; margin: 15px 0; text-transform: uppercase; }
    </style>
</head>
<body>

<div id="log">> SYSTEM REBOOT v6.0
> Status: Awaiting Connection...</div>

<div class="card">
    <div class="flex justify-between">
        <div><span class="label">BUDGET</span><div class="val">$1000</div></div>
        <div class="text-right"><span class="label">BTC LIVE</span><div id="btc" class="val text-green-400">---</div></div>
    </div>
</div>

<div class="card">
    <span class="label">ALLOCATION CONTROL</span>
    <div class="mt-2">
        <div class="flex justify-between text-[11px]"><span>DUTCH</span><span id="v-d">50%</span></div>
        <input type="range" id="s-d" min="0" max="100" value="50" oninput="balance('d')">
        
        <div class="flex justify-between text-[11px]"><span>METEO</span><span id="v-m">30%</span></div>
        <input type="range" id="s-m" min="0" max="100" value="30" oninput="balance('m')">
        
        <div class="flex justify-between text-[11px]"><span>RARE</span><span id="v-r">20%</span></div>
        <input type="range" id="s-r" min="0" max="100" value="20" oninput="balance('r')">
    </div>
</div>

<div class="card">
    <span class="label">API KEY ACCESS</span>
    <input type="password" id="key" placeholder="PASTE YOUR GEMINI KEY HERE">
    <button onclick="boot()" class="btn-big">INITIALIZE SYSTEM</button>
</div>

<div class="text-center pb-10">
    <span class="label">ACTIVE TOKENS:</span>
    <span id="tkn" class="text-white font-bold ml-2">0</span>
</div>

<script>
    function l(msg, col='') {
        const log = document.getElementById('log');
        log.innerHTML += `<div style="color:${col}">> ${msg}</div>`;
        log.scrollTop = log.scrollHeight;
    }

    function balance(active) {
        let d = document.getElementById('s-d'), m = document.getElementById('s-m'), r = document.getElementById('s-r');
        let total = parseInt(d.value) + parseInt(m.value) + parseInt(r.value);
        let diff = total - 100;
        if (active === 'd') { m.value = Math.max(0, parseInt(m.value) - diff); r.value = 100 - parseInt(d.value) - parseInt(m.value); }
        else if (active === 'm') { d.value = Math.max(0, parseInt(d.value) - diff); r.value = 100 - parseInt(d.value) - parseInt(m.value); }
        else { d.value = Math.max(0, parseInt(d.value) - diff); m.value = 100 - parseInt(d.value) - parseInt(r.value); }
        document.getElementById('v-d').innerText = d.value + '%';
        document.getElementById('v-m').innerText = m.value + '%';
        document.getElementById('v-r').innerText = r.value + '%';
    }

    async function boot() {
        const key = document.getElementById('key').value.trim();
        if(!key) return l("ERROR: KEY MISSING", "red");
        
        l("STARTING BRUTE-FORCE CONNECTION...");
        
        // Testiamo versioni e modelli in sequenza per eliminare il NOT_FOUND
        const trials = [
            {v: 'v1beta', m: 'gemini-1.5-flash'},
            {v: 'v1', m: 'gemini-1.5-flash'},
            {v: 'v1beta', m: 'gemini-1.5-flash-8b'},
            {v: 'v1', m: 'gemini-pro'}
        ];

        for(let t of trials) {
            try {
                l(`TRYING: ${t.v} / ${t.m}...`);
                const res = await fetch(`https://generativelanguage.googleapis.com/${t.v}/models/${t.m}:generateContent?key=${key}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({contents:[{parts:[{text:"ping"}]}]})
                });
                const data = await res.json();
                
                if(data.candidates) {
                    l(`STABLE CONNECTION: ${t.m}`, "#00ff41");
                    document.getElementById('tkn').innerText = data.usageMetadata.totalTokenCount;
                    return;
                } else {
                    l(`FAIL: ${data.error?.message || "REJECTED"}`, "orange");
                }
            } catch(e) { l("NET ERROR", "red"); }
        }
        l("CRITICAL: ALL MODELS REJECTED. CHECK API CONSOLE.", "red");
    }

    (function connect() {
        const ws = new WebSocket('wss://stream.binance.com:9443/ws/btcusdt@ticker');
        ws.onmessage = (e) => {
            const data = JSON.parse(e.data);
            document.getElementById('btc').innerText = "$" + Math.round(data.c);
        };
    })();
</script>
</body>
</html>
