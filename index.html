<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oracle v1.6 | Vertical Beast</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --neon: #00ff41; --bg: #0a0b0d; --panel: #161b22; }
        body, html { height: 100%; margin: 0; background: var(--bg); color: var(--neon); font-family: 'Roboto Mono', monospace; overflow: hidden; }
        .wrapper { display: flex; flex-direction: column; height: 100vh; }
        
        /* Dashboard 75% - Log 25% */
        .dash { height: 75%; padding: 15px; overflow-y: auto; border-bottom: 2px solid #30363d; display: flex; flex-direction: column; gap: 12px; }
        .logs { height: 25%; background: #000; padding: 10px; font-size: 11px; overflow-y: auto; color: #58a6ff; border-top: 1px solid var(--neon); }
        
        .card { background: var(--panel); border: 1px solid #30363d; border-radius: 12px; padding: 15px; }
        .stat-big { font-size: 24px; font-weight: bold; letter-spacing: -1px; }
        .label-u { font-size: 10px; color: #8b949e; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; display: block; }
        
        /* Slider personalizzati */
        input[type=range] { width: 100%; accent-color: var(--neon); height: 8px; border-radius: 5px; background: #30363d; outline: none; }
        .val-bubble { background: var(--neon); color: #000; font-weight: bold; padding: 2px 8px; border-radius: 4px; font-size: 14px; }
        
        input[type=number], input[type=password] { background: #0d1117 !important; color: var(--neon) !important; border: 1px solid #30363d !important; padding: 10px; border-radius: 6px; font-size: 16px; }
        .btn-action { background: var(--neon); color: #000; font-weight: 900; padding: 18px; border-radius: 8px; text-transform: uppercase; width: 100%; box-shadow: 0 4px 14px 0 rgba(0,255,65,0.39); }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="dash">
        <div class="flex justify-between items-center">
            <span class="text-xs font-black">VIBE-ORACLE v1.6</span>
            <span id="tkn" class="text-[10px] font-bold text-green-500">TOKENS: 0</span>
        </div>

        <div class="grid grid-cols-2 gap-3">
            <div class="card">
                <span class="label-u">Budget Demo ($)</span>
                <input type="number" id="budget" value="1000" class="w-full text-center" onchange="updateUI()">
            </div>
            <div class="card flex flex-col items-center justify-center border-green-500">
                <span class="label-u">BTC LIVE</span>
                <div id="btc" class="stat-big text-green-400">---</div>
            </div>
        </div>

        <div class="card space-y-4">
            <span class="label-u">Allocazione Wallet (%)</span>
            <div>
                <div class="flex justify-between mb-2"><span>Dutch Arb</span> <span id="v-d" class="val-bubble">50</span></div>
                <input type="range" id="s-d" min="0" max="100" value="50" oninput="syncRange('d')">
            </div>
            <div>
                <div class="flex justify-between mb-2"><span>Meteo</span> <span id="v-m" class="val-bubble">30</span></div>
                <input type="range" id="s-m" min="0" max="100" value="30" oninput="syncRange('m')">
            </div>
            <div>
                <div class="flex justify-between mb-2"><span>Rare Ops</span> <span id="v-r" class="val-bubble">20</span></div>
                <input type="range" id="s-r" min="0" max="100" value="20" oninput="syncRange('r')">
            </div>
        </div>

        <div class="card">
            <span class="label-u">Profit Re-Investment</span>
            <div class="grid grid-cols-2 gap-4 text-center mt-2">
                <div><span class="text-[10px]">METEO > DUTCH</span><br><input type="number" id="p-m" value="80" class="w-20 mt-1"> %</div>
                <div><span class="text-[10px]">RARE > DUTCH</span><br><input type="number" id="p-r" value="80" class="w-20 mt-1"> %</div>
            </div>
        </div>

        <div class="space-y-3 mt-auto">
            <input type="password" id="key" placeholder="INCOLLA GEMINI API KEY" class="w-full">
            <div class="flex gap-2">
                <button id="m-btn" onclick="tMode()" class="w-1/3 bg-blue-900 font-bold rounded">DEMO</button>
                <button onclick="boot()" class="btn-action">Avvia Oracle</button>
            </div>
        </div>
    </div>

    <div id="log" class="logs">
[ORACLE READY] - Dashboard ottimizzata per Android.<br>
- WebSocket Binance: In attesa.<br>
- Logica Rebalancing: Attiva.
    </div>
</div>

<script>
    let isR = false; let ws = null;

    function l(m, c='') { 
        const log = document.getElementById('log');
        log.innerHTML += `<div class="${c}">> ${m}</div>`;
        log.scrollTop = log.scrollHeight;
    }

    function syncRange(t) {
        const sd = document.getElementById('s-d');
        const sm = document.getElementById('s-m');
        const sr = document.getElementById('s-r');
        
        let d = parseInt(sd.value); let m = parseInt(sm.value); let r = parseInt(sr.value);
        let total = d + m + r;
        
        if(total > 100) {
            if(t==='d') sm.value = Math.max(0, 100 - d - r);
            if(t==='m') sr.value = Math.max(0, 100 - d - m);
            if(t==='r') sm.value = Math.max(0, 100 - d - r);
        }
        
        document.getElementById('v-d').innerText = sd.value;
        document.getElementById('v-m').innerText = sm.value;
        document.getElementById('v-r').innerText = sr.value;
    }

    function tMode() {
        isR = !isR;
        const b = document.getElementById('m-btn');
        b.innerText = isR ? "REAL" : "DEMO";
        b.className = isR ? "w-1/3 bg-red-900 font-bold rounded" : "w-1/3 bg-blue-900 font-bold rounded";
    }

    async function boot() {
        const k = document.getElementById('key').value.trim();
        if(!k) return alert("Inserisci API Key");
        
        l("Inizializzazione Oracoli...");
        try {
            const resp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${k}`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ contents: [{ parts: [{ text: "ping" }] }] })
            });
            const data = await resp.json();
            if(data.usageMetadata) {
                document.getElementById('tkn').innerText = "TOKENS: " + data.usageMetadata.totalTokenCount;
                l("Handshake Gemini OK. Attivazione WebSocket...", "text-green-400");
                initWS();
            }
        } catch (e) { l("ERRORE: " + e.message, "text-red-500"); }
    }

    function initWS() {
        if(ws) ws.close();
        ws = new WebSocket('wss://stream.binance.com:9443/ws/btcusdt@ticker');
        ws.onmessage = (e) => {
            const d = JSON.parse(e.data);
            document.getElementById('btc').innerText = "$" + Math.round(d.c);
        };
        ws.onerror = () => l("ERRORE WS: Controlla la VPN!", "text-red-500");
    }
</script>
</body>
</html>
